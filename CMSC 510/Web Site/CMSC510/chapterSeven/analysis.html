<!DOCTYPE html>
<html>
<head>
<link href="../../bootstrap.min.css" rel="stylesheet" type="text/css">
<title>Chapter 7 Part One</title>
</head>
<body>
<div class="container">
<h3>The Quicksort algorithm</h3>
<pre>
QUICKSORT(A,p,r)
  if p &lt; r
    q = PARTITION(A,p,r)
    QUICKSORT(A,p,q-1)
    QUICKSORT(A,q+1,r)

PARTITION(A,p,r)
  x = A[r]
  i = p-1
  for j = p to r-1
    if A[j] &lt;= x
      i = i + 1
      exchange A[i] with A[j]
  exchange A[i+1] with A[r]
  return i + 1
</pre>
<p class="text-center"><img src="analysis1.png"/></p>
<h3>Computing the runtime efficiency of Quicksort</h3>
<p>Here are some key observations about the behavior of Quicksort:</p>
<ol>
<li>Almost all of the work that Quicksort does takes place in the calls to Partition.</li>
<li>One of the most frequent operations in a call to Partition is the comparison test.</li>
<li>The total work done in a call to Partition is bounded above by some multiple of the number of times the comparison test runs.</li>
<li>The comparison test compares the current pivot against other numbers in the subarray.</li>
<li>Once a number gets to be a pivot in a call to Partition, no other call to Partition will use that number in any way.</li>
<li>If we index the numbers in the original list by their final position in the array after sorting, then we can see that <i>x</i><sub><i>i</i></sub> will get compared with <i>x</i><sub><i>j</i></sub> if and only if one of these two numbers gets to be a pivot before any of the numbers between them is chosen as a pivot.</li>
</ol>
<p>Here is a probabilistic argument that estimates the total number of comparisons.</p>
<p>Introduce the random variable</p>
<p class="text-center"><img src="analysis2.png"/></p>
<p>In terms of this variable, the random variable that represents the total number of comparisons is</p>
<p class="text-center"><img src="analysis3.png"/></p>
<p>We want to compute the expected value of <i>X</i>, which will yield the total number of comparisons in Quicksort.</p>
<p class="text-center"><img src="analysis4.png"/></p>
<p><i>E</i>[<i>X</i><sub><i>i</i>,<i>j</i></sub>] is just the probability that <i>x</i><sub><i>i</i></sub> gets compared with <i>x</i><sub><i>j</i></sub>. What is that probability? It is easiest to compute the probability that <i>x</i><sub><i>i</i></sub> does not get compared with <i>x</i><sub><i>j</i></sub>: that will happen if any of the numbers between <i>x</i><sub><i>i</i></sub> and <i>x</i><sub><i>j</i></sub> gets chosen as pivot first. Assuming that every number has an equal probability of being chosen first, that probability is simply</p>
<p class="text-center"><img src="analysis5.png"/></p>
<p>Thus</p>
<p class="text-center"><img src="analysis6.png"/></p>
<p>and</p>
<p class="text-center"><img src="analysis7.png"/></p>
<h3>Randomized Quicksort</h3>
<p class="text-center"><img src="analysis8.png" width="400"/></p>
<p></p>
<p class="text-center"><img src="analysis9.png" width="500"/></p>
</div>
</body>
</html>
